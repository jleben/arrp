
##input in[~]real64;

Nx = 1000;
Ny = 1000;

hz = [~,Nx,Ny:
  0,i,j -> i*(j+3) / Nx;
  t,0,0 -> hz[t-1,0,0];
  t,i,j -> hz[t-1,i,j] - 0.7 * (ex[t,i,j+1] - ex[t,i,j] +
                                ey[t,i+1,j] - ey[t,i,j]);
]
where {

ex = [~,Nx,Ny:
  0,i,j -> i*(j+1) / Nx;
  t,i,0 -> ex[t-1,i,0];
  t,i,j -> ex[t-1,i,j] - 0.5 * (hz[t-1,i,j] - hz[t-1,i,j-1]);
];

ey = [~,Nx,Ny:
  0,i,j -> i*(j+2) / Ny;
  ##t,0,j -> in[t];
  t,0,j -> t;
  t,i,j -> ey[t-1,i,j] - 0.5 * (hz[t-1,i,j] - hz[t-1,i-1,j]);
];

};

main = [~: t -> hz[t,0,0]];
